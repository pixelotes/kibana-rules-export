name: kibana-rules-export
version: "1.0"
help: Command-line tool to export enabled detection rules from Kibana to JSON, CSV or Markdown format using the Detection Engine KiAPI.

x_markdown_footer: |
  ## Building the script manually
  
  ### Setup
  
  ~~~bash
  gem install bashly
  ~~~
  
  ### Build
  ~~~bash
  bashly generate
  ~~~
  
  ## Output
  rules.json, rules.csv or rules.md will be created in the current directory.

dependencies:
  - jq
  - curl
  - bash

flags:
  - long: --username
    arg: USERNAME
    required: true
    help: Kibana username
  - long: --password
    arg: PASSWORD
    required: true
    help: Kibana password
  - long: --url
    arg: URL
    default: http://localhost:5601
    help: Kibana base URL
  - long: --page_size
    arg: PAGE_SIZE
    required: false
    default: "1000"
    help: Number of results returned per page
  - long: --format
    arg: FORMAT
    default: csv
    allowed: [csv, markdown, json]
    help: Output format (csv, markdown or json)
  - long: --insecure
    help: Skip SSL certificate verification

commands: []
