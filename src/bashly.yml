name: kibana-rules-export
version: "1.0"
help: Export enabled detection rules from Kibana to CSV or Markdown
long_help: |
  :markdown
  # kibana-rules-export
  
  Command-line tool to export enabled detection rules from Kibana to CSV or Markdown format using the Detection Engine API.
  
  ## Features
  
  - Connects to a Kibana instance
  - Retrieves all enabled detection rules
  - Outputs a table with: Name, Description, Tags, Query
  - Supports output in CSV or Markdown format

  ---


dependencies:
  - jq
  - curl

flags:
  - long: --username
    arg: USERNAME
    required: true
    help: Kibana username
  - long: --password
    arg: PASSWORD
    required: true
    help: Kibana password
  - long: --url
    arg: URL
    default: http://localhost:5601
    help: Kibana base URL
  - long: --page_size
    arg: PAGE_SIZE
    required: false
    default: "1000"
    help: Number of results returned per page
  - long: --format
    arg: FORMAT
    default: csv
    allowed: [csv, markdown, json]
    help: Output format (csv, markdown or json)
  - long: --insecure
    help: Skip SSL certificate verification

commands: []
