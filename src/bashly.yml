name: kibana-rules-export
version: "1.0"
help: Export enabled detection rules from Kibana to CSV or Markdown

x_markdown_footer: |
  Command-line tool to export enabled detection rules from Kibana to CSV or Markdown format using the Detection Engine API.

  ## Features
  
  - Connects to a Kibana instance
  - Retrieves all enabled detection rules
  - Outputs a table with: Name, Description, Tags, Query
  - Supports output in CSV or Markdown format
  
  ## Building the script manually
  
  ### Setup
  
  ```bash
  gem install bashly
  ```
  
  ### Build
  ```bash
  bashly generate
  ```
  
  ## Usage
  ```bash
  ./kibana-rules-export --username USER --password PASS [--url URL] [--page_size PAGE_SIZE] [--format csv|markdown] [--insecure]
  ```

dependencies:
  - jq
  - curl
  - bash

flags:
  - long: --username
    arg: USERNAME
    required: true
    help: Kibana username
  - long: --password
    arg: PASSWORD
    required: true
    help: Kibana password
  - long: --url
    arg: URL
    default: http://localhost:5601
    help: Kibana base URL
  - long: --page_size
    arg: PAGE_SIZE
    required: false
    default: "1000"
    help: Number of results returned per page
  - long: --format
    arg: FORMAT
    default: csv
    allowed: [csv, markdown, json]
    help: Output format (csv, markdown or json)
  - long: --insecure
    help: Skip SSL certificate verification

commands: []
